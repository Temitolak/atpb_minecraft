---
- name: Prepare the Minecraft Server!
  gather_facts: false
  hosts: all
  become: yes
  
  tasks:

  - name: install python
    raw: sudo apt install python -y

- name: Prepare the Minecraft Server!
  hosts: all
  become: yes
  
  tasks:

  - name: Update the Minecrat Server - Packages to latest version control
    apt: upgrade=dist update_cache=yes
    
  - name: Add apt_repo for java
    apt_repository:
      repo: ppa:webupd8team/java
      state: present
   
  - name: Install oracle-java8
    shell: "apt install oracle-java8-installer -y"
    
  - name: Set Oracle JDK8 as default with this package avail in webupd8team/java
    shell: "apt install oracle-java8-set-default -y"
    
  - name: Install screen
    apt: name=screen state=present
    
  - name: Install git
    apt: name=git state=present
    
  - name: Install fail2ban
    apt: name=fail2ban state=present

  - name: Copy fail2ban
    copy: src=/etc/fail2ban/jail.conf dest=/etc/fail2ban/jail.local remote_src=true

  - name: Update fail2ban policy
    lineinfile: dest=/etc/fail2ban/jail.local regexp="^bantime  = 600$" line="bantime  = 20000"
    
  - name: Restart fail2ban
    service: name=fail2ban state=restarted

  - name: Reboot server
    command: /sbin/reboot
